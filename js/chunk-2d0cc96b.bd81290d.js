(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0cc96b"],{"4f25":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row justify-content-center mt-5"},[a("div",{staticClass:"col-md-9"},[a("div",{staticClass:"table-responsive"},[a("table",{staticClass:"table table-hover"},[t._m(0),a("tbody",t._l(t.coupons,(function(e){return a("tr",{key:e.id},[a("td",[t._v(t._s(t._f("dateFormate")(e.dueDate)))]),a("td",[t._v(t._s(e.title))]),a("td",[t._v(t._s(e.code))]),a("td",{staticClass:"text-right"},[t._v(t._s(e.percent)+" %")]),a("td",{staticClass:"text-right"},[e.is_enabled?a("span",{staticClass:"text-success"},[t._v("啟用")]):a("span",[t._v("未啟用")])]),a("td",{staticClass:"text-right d-flex justify-content-around"},[a("button",{staticClass:"btn btn-outline-primary btn-sm",on:{click:function(a){return t.openModal("edit",e)}}},[t._v(" 編輯 ")]),a("button",{staticClass:"btn btn-outline-danger btn-sm",on:{click:function(a){return t.openModal("delete",e)}}},[t._v(" 刪除 ")])])])})),0)])])]),a("div",{staticClass:"col-md-3"},[a("div",{staticClass:"card card-shadow"},[a("div",{staticClass:"card-body"},[a("form",{on:{submit:function(e){return e.preventDefault(),t.createNewCoupon(e)}}},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"couponTitle"}},[t._v("優惠券名稱")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],staticClass:"form-control",attrs:{type:"text",id:"couponTitle"},domProps:{value:t.title},on:{input:function(e){e.target.composing||(t.title=e.target.value)}}})]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"couponTitle"}},[t._v("折扣碼")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.code,expression:"code"}],staticClass:"form-control",attrs:{type:"text",id:"couponCode"},domProps:{value:t.code},on:{input:function(e){e.target.composing||(t.code=e.target.value)}}})]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"couponDueDate"}},[t._v("截止日期")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.dueDate,expression:"dueDate"}],staticClass:"form-control",attrs:{type:"date",id:"couponDueDate"},domProps:{value:t.dueDate},on:{input:function(e){e.target.composing||(t.dueDate=e.target.value)}}})]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"couponPercent"}},[t._v("折扣百分比")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.percent,expression:"percent"}],staticClass:"form-control",attrs:{type:"number",id:"couponPercent",placeholder:"折扣數，單位百分比"},domProps:{value:t.percent},on:{input:function(e){e.target.composing||(t.percent=e.target.value)}}})]),a("div",{staticClass:"form-group form-check"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.is_enabled,expression:"is_enabled"}],staticClass:"form-check-input",attrs:{type:"checkbox",id:"couponEnabled"},domProps:{checked:Array.isArray(t.is_enabled)?t._i(t.is_enabled,null)>-1:t.is_enabled},on:{change:function(e){var a=t.is_enabled,o=e.target,s=!!o.checked;if(Array.isArray(a)){var i=null,n=t._i(a,i);o.checked?n<0&&(t.is_enabled=a.concat([i])):n>-1&&(t.is_enabled=a.slice(0,n).concat(a.slice(n+1)))}else t.is_enabled=s}}}),a("label",{staticClass:"form-check-label",attrs:{for:"couponEnabled"}},[t._v("是否啟用")])]),t._m(1)])])])]),a("div",{staticClass:"modal fade",attrs:{id:"couponEditModal",tabindex:"-1",role:"dialog"}},[a("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[a("div",{staticClass:"modal-content"},[t._m(2),a("div",{staticClass:"modal-body"},[a("form",[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"couponEditTitle"}},[t._v("優惠券名稱")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.template.title,expression:"template.title"}],staticClass:"form-control",attrs:{type:"text",id:"couponEditTitle"},domProps:{value:t.template.title},on:{input:function(e){e.target.composing||t.$set(t.template,"title",e.target.value)}}})]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"couponEditDueDate"}},[t._v("截止日期")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.template.dueDate,expression:"template.dueDate"}],staticClass:"form-control",attrs:{type:"date",id:"couponEditDueDate"},domProps:{value:t.template.dueDate},on:{input:function(e){e.target.composing||t.$set(t.template,"dueDate",e.target.value)}}})]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"couponEditPercent"}},[t._v("折扣百分比")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.template.percent,expression:"template.percent"}],staticClass:"form-control",attrs:{type:"number",id:"couponEditPercent",placeholder:"折扣數，單位百分比"},domProps:{value:t.template.percent},on:{input:function(e){e.target.composing||t.$set(t.template,"percent",e.target.value)}}})]),a("div",{staticClass:"form-group form-check"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.template.is_enabled,expression:"template.is_enabled"}],staticClass:"form-check-input",attrs:{type:"checkbox",id:"couponEditEnabled"},domProps:{checked:Array.isArray(t.template.is_enabled)?t._i(t.template.is_enabled,null)>-1:t.template.is_enabled},on:{change:function(e){var a=t.template.is_enabled,o=e.target,s=!!o.checked;if(Array.isArray(a)){var i=null,n=t._i(a,i);o.checked?n<0&&t.$set(t.template,"is_enabled",a.concat([i])):n>-1&&t.$set(t.template,"is_enabled",a.slice(0,n).concat(a.slice(n+1)))}else t.$set(t.template,"is_enabled",s)}}}),a("label",{staticClass:"form-check-label",attrs:{for:"couponEditEnabled"}},[t._v("是否啟用")])])])]),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v("取消")]),a("button",{staticClass:"btn btn-success",attrs:{type:"submit"},on:{click:t.editCoupon}},[t._v("確認修改")])])])])]),a("div",{staticClass:"modal fade",attrs:{id:"delCouponModal",tabindex:"-1",role:"dialog"}},[a("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[a("div",{staticClass:"modal-content"},[t._m(3),a("div",{staticClass:"modal-body"},[t._v(" 確定要刪除 "),a("span",{staticClass:"text-danger font-weight-bold"},[t._v(t._s(t.template.title))]),t._v(" 優惠券嗎 ? (刪除後無法復原) ")]),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v("取消")]),a("button",{staticClass:"btn btn-danger",attrs:{type:"button"},on:{click:t.deleteCoupon}},[t._v("刪除")])])])])])])},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",{staticClass:"thead-light"},[a("th",[t._v("截止日期")]),a("th",[t._v("優惠券名稱")]),a("th",[t._v("折扣碼")]),a("th",{staticClass:"text-right"},[t._v("折扣數")]),a("th",{staticClass:"text-right"},[t._v("是否啟用")]),a("th",{staticClass:"text-center",attrs:{width:"150"}},[t._v("編輯")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"text-right"},[a("button",{staticClass:"btn btn-warning",attrs:{type:"submit"}},[t._v("新增")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-header bg-dark text-white"},[a("h5",{staticClass:"modal-title",attrs:{id:"couponEditModalLabel"}},[t._v("修改優惠券")]),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-header bg-danger text-white"},[a("h5",{staticClass:"modal-title",attrs:{id:"delCouponLabel"}},[t._v("刪除優惠券")]),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])}],i=(a("99af"),{data:function(){return{title:"",code:"",dueDate:"",percent:"",is_enabled:!0,coupons:[],template:{}}},methods:{getCoupons:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=this,a="".concat("https://vue-course-api.hexschool.io","/api/").concat("kenapi","/admin/coupons?page=").concat(t);e.$store.dispatch("updateLoading",!0),axios.get(a).then((function(t){e.coupons=t.data.coupons,e.$store.dispatch("updateLoading",!1)}))},createNewCoupon:function(){var t=this,e="".concat("https://vue-course-api.hexschool.io","/api/").concat("kenapi","/admin/coupon");t.$store.dispatch("updateLoading",!0),t.dueDate=new Date(t.dueDate).getTime()/1e3;var a={data:{title:t.title,code:t.code,dueDate:t.dueDate,percent:t.percent,is_enabled:t.is_enabled}};axios.post(e,a).then((function(){t.getCoupons(),t.$store.dispatch("updateLoading",!1)}))},openModal:function(t,e){var a=this;switch(a.template=Object.assign({},e),t){case"edit":var o=new Date(1e3*e.dueDate),s="".concat(o.getFullYear(),"-").concat(o.getMonth()+1,"-").concat(o.getDate());a.template.dueDate=s,$("#couponEditModal").modal("show");break;default:$("#delCouponModal").modal("show");break}},editCoupon:function(){var t=this,e="".concat("https://vue-course-api.hexschool.io","/api/").concat("kenapi","/admin/coupon/").concat(t.template.id);t.$store.dispatch("updateLoading",!0);var a={title:t.template.title,is_enabled:t.template.is_enabled,percent:t.template.percent,due_date:new Date(t.template.dueDate).getTime()};axios.put(e,{data:a}).then((function(){t.getCoupons(),$("#couponEditModal").modal("hide"),t.$store.dispatch("updateLoading",!1)}))},deleteCoupon:function(){var t=this,e="".concat("https://vue-course-api.hexschool.io","/api/").concat("kenapi","/admin/coupon/").concat(t.template.id);t.$store.dispatch("updateLoading",!0),$("#deleteModal").modal("show"),axios.delete(e).then((function(){t.getCoupons(),$("#delCouponModal").modal("hide"),t.$store.dispatch("updateLoading",!1)}))}},created:function(){this.getCoupons()}}),n=i,l=a("2877"),c=Object(l["a"])(n,o,s,!1,null,null,null);e["default"]=c.exports}}]);
//# sourceMappingURL=chunk-2d0cc96b.bd81290d.js.map